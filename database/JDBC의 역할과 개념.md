# JDBC의 역할과 개념

## WAS와 DB 서버의 연결

- 클라이언트는 WAS를 통해 DB에 접근.

클라이언트가 WAS를 통해서 데이터를 저장하거나 조회하면 WAS는 다음 과정을 통해서 DB에 접근하여 사용한다.

![Untitled](https://i.imgur.com/GQVfG2v.png)

1. **Connection 연결**
    
    주로 `TCP/IP` 를 사용해서 커넥션을 연결.
    
2. **SQL 전달**
    
    WAS는 DB가 이해할 수 있는 `SQL` 을 연결된 커넥션을 통해 DB에 전달.
    
3. **결과 응답**
    
    DB는 전달된 SQL을 수행하고 그 결과를 응답. WAS는 응답 결과를 활용한다.
    

### 위 구조의 문제점

😅 문제는 각각의 DB마다 커넥션을 연결하고 SQL을 전달하고 결과를 응답 받는 방법이 **모두 다르다**.

- DB를 다른 종류의 DB로 변경하면 WAS에 개발된 DB 코드도 함께 변경해야한다.
- 개발자는 새로운 DB를 학습해야한다.

이러한 문제를 해결하기 위해서 JDBC 자바 표준이 등장했다.

## JDBC 자바 표준의 등장

`JDBC란?`

- 자바에서 **DB에 접속할 수 있도록** 하는 자바 API
- DB에서 데이터를 쿼리하거나 업데이트하는 방법을 제공

어플리케이션 로직이 DB에 의존성을 갖고있던 과거와 달리, JDBC 표준 인터페이스에 의존성을 두어 다양한 DB를 사용할 수 있도록 하였다.

![스크린샷 2022-09-04 오후 6.19.08.png](https://i.imgur.com/PDi63QE.png)

JDBC는 3가지 대표 기능을 표준 인터페이스로 정의해서 제공한다.

- `java.sql.Connection` - 커넥션 연결
- `java.sql.Statement` - SQL을 담은 내용
- `java.sql.ResultSet` - SQL 요청 응답

DB 벤더들은 통일된 JDBC 표준 인터페이스에 맞춰서 JDBC 드라이버를 구현하여 제공한다.

(MySQL DB에 접근할 수 있는 것은 MySQL JDBC 드라이버라고 한다.)

### Jdbc의 장점

- DB를 다른 종류로 변경하더라도 WAS의 DB 사용 코드를 변경할 필요가 없다.
    - 어플리케이션 로직이 Jdbc 표준 인터페이스에 의존한다.
    - DB를 다른 종류로 변경하고 싶으면 Jdbc 구현 라이브러리 (드라이버)만 변경하면 된다.
    - WAS의 코드를 그대로 유지할 수 있다.

- 개발자는 Jdbc 표준 인터페이스 사용법만 알면 된다.
    - DB마다 커넥션 연결, SQL 전달, 그리고 그 결과를 응답 받는 방법을 새로 학습하지 않아도 된다.
    

하지만…

어플리케이션에서 DB에 접근할 수 있도록 하는 Jdbc 코드는 표준화 되었지만, 각 Jdbc 드라이버에서 사용되는 SQL은 표준화되지 않았다. 

→ JPA와 같은 ORM을 통해서 해결 가능.

## Jdbc를 편리하게 사용하는 다양한 기술들

Jdbc는 사용법이 복잡하기 때문에 직접 사용하기 보다는 다양한 기술의 도움을 받아 사용된다.

- `SQL Mapper`
- `ORM`

### SQL Mapper (JdbcTemplate, MyBatis)

![Untitled](https://i.imgur.com/q99BCSU.png)

- 장점
    - SQL 응답 결과를 객체로 편리하게 변환한다.
    - Jdbc의 반복 코드를 제거한다.

- 단점
    - 개발자가 SQL을 직접 작성한다.

### ORM (JPA - 하이버네이트)

![Untitled](https://i.imgur.com/CZf1kw3.png)

- 장점
    - 객체를 관계형 DB 테이블과 매핑
        - OOP 기반의 어플리케이션 로직과 DB의 간격이 줄어듬
    - 반복적인 SQL을 동적으로 만들어 실행
    - DB 마다 다른 SQL을 통일

SQL Mapper와 ORM도 결국엔 내부에서 Jdbc를 사용한다.

따라서 Jdbc가 어떻게 동작하는지 기본 원리를 아는 것이, 문제의 근본을 찾아서 해결하는데 도움이 된다.